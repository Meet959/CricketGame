<!DOCTYPE html>
<style>
    .tb {
        width: 60% !important;
        text-transform:uppercase;   
    }

    body {
        background: radial-gradient(690.87% 145.6% at 17.03% 29.86%, #B4FFB2 1.84%, #58B97F 34.31%, #054949 100%);
    }
    h3 {
        color: #35894d;
    }
    .es-header.sticky-header {
        position: fixed;
        top: 0;
        background: #35894d;
        width: 100%;
    }

    .cards-list {
        z-index: 0;
        width: 100%;
        display: flex;
        justify-content: space-around;
        flex-wrap: wrap;
    }

    .card {
        margin: 30px auto;
        width: 200px;
        height: 200px;
        /*border-radius: 40px;*/
        cursor: pointer;
        transition: 0.4s;
        border: none
    }

        .card .card_image {
            width: inherit;
            height: inherit;
            border-radius: 40px;
        }

            .card .card_image img {
                width: inherit;
                height: inherit;
                border-radius: 40px;
                object-fit: cover;
            }

    /*    .card .card_title {
            text-align: center;
            border-radius: 0px 0px 0px 40px;
            font-family: sans-serif;
            font-weight: bold;
            font-size: 18px;
            margin-top: -150px;
            height: 40px;
            color: deeppink
        }*/
        .card .card_title {
            text-align: center;
            border-radius: 0px 0px 0px 40px;
            font-family: fantasy;
            /* font-weight: 100; */
            font-size: 38px;
            margin-top: -150px;
            height: 40px;
            color: #cd517b;
        }

        .card:hover {
            transform: scale(0.9, 0.9);
            box-shadow: 5px 5px 30px 15px rgba(0,0,0,0.25), -5px -5px 30px 15px rgba(0,0,0,0.22);
        }

    .title-white {
        color: white;
    }

    .title-black {
        color: black;
    }

    @media all and (max-width: 500px) {
        .card-list {
            /* On small screens, we are no longer using row direction but column */
            flex-direction: column;
        }
    }
</style>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="index.js"></script>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <meta charset="utf-8" />
    <title>Distribute</title>
</head>
<body>
    <section class="es-header sticky-header">

        <div class="es-logo">
            <img src="https://www.sbo.net/wp-content/uploads/2022/07/92-right@1x.png" height="80px" width="100px" style="padding:0;float:left" alt="Entity Logo">
                        <p id="matchTitle" style="color:white;font-family: fantasy;font-size:40px;text-align:center;font-weight: 200;padding-top: 10px;"></p>
 
			
			<iframe src="https://free.timeanddate.com/clock/i9baleut/n423/tlin7/fn14/fs19/fcfff/tct/pct/pd2/tt0/tw0/th2/tb4" frameborder="0" width="134" style="float:right;margin-top:-3.5%" height="51" allowtransparency="true"></iframe>

            <div class="" id="GoToPreviousStats">   <a type="button" onclick="GetAllStats(false)" class="btn btn-warning" href="Stats.html">Go To Old Stats</a></div>
        </div>
        
    </section>
    <div class="row" style="min-height:780px">
        <div style="float:left;width:30%;margin-top:12%">
            <div class=" row" style="float:left;display:contents">
                <div class="col-sm-12 mb-3">    <input class="tb form-control form-control-sm " placeholder="Player 1" type="text" id="p1" value=""></div>
                <div class="col-sm-12 mb-3">    <input class="tb form-control form-control-sm " placeholder="Player 2" type="text" id="p2" value=""></div>
                <div class="col-sm-12 mb-3">    <input class="tb form-control form-control-sm " placeholder="Player 3" type="text" id="p3" value=""></div>
                <div class="col-sm-12 mb-3">    <input class="tb form-control form-control-sm " placeholder="Player 4" type="text" id="p4" value=""></div>
                <div class="col-sm-12 mb-3">    <input class="tb form-control form-control-sm " placeholder="Player 5" type="text" id="p5" value=""></div>
                <div class="col-sm-12 mb-3">    <input class="tb form-control form-control-sm " placeholder="Player 6" type="text" id="p6" value=""></div>
                <div class="col-sm-12 mb-3">    <input class="tb form-control form-control-sm " placeholder="Player 7" type="text" id="p7" value=""></div>
                <div class="col-sm-12 mb-3">    <input class="tb form-control form-control-sm " placeholder="Player 8" type="text" id="p8" value=""></div>
                <div class="row">
                    <div class="col-sm-3 mr-3">    <input class="btn btn-warning  " type="button" id="btnSubmit" value="Let's Go !" onclick="distribute()"></div>
                    <div class="col-sm-6" id="DivStatsBtn" style="display: none;">   <a type="button" onclick="GetAllStats(true)" class="btn btn-warning" href="Stats.html">Go To New Stats</a></div>
                </div>
            </div>
        </div>
        <div style="float: right; width: 50%; margin-top: 12%">
            <div>
                <div class="cards-list" id="cardList"></div>
            </div>
        </div>
    </div>

    <div>

        <img src="https://uiparadox.co.uk/templates/cricket-pulse/assets/media/banner/hero-banner-bottom-vector.png" />
    </div>

    <script type="text/javascript">
        $(document).ready(()=>{
            
            if(localStorage.getItem("C1") != "")
            {
                $("#cardList").html('');
                for (var i = 0; i < 8; i++) {
                    var card = localStorage.getItem("C"+(i+1))
                    $("#cardList").append('<div class="card ' + [i] + '"><div class="card_image"> </div><div class="card_title title-white"><p>' + card.toString() + ' <br/></p></div></div>');
                }
                $("#DivStatsBtn").css("display","")
            }
        });

        $(function () {
            $("#btnSubmit").val("Let's Go!");

            var p1_local = localStorage.getItem("p1");
            var p2_local = localStorage.getItem("p2");
            var p3_local = localStorage.getItem("p3");
            var p4_local = localStorage.getItem("p4");
            var p5_local = localStorage.getItem("p5");
            var p6_local = localStorage.getItem("p6");
            var p7_local = localStorage.getItem("p7");
            var p8_local = localStorage.getItem("p8");

            if (p1_local != null && p1_local != '') {
                $("#p1").val(p1_local);
            }
            if (p2_local != null && p2_local != '') {
                $("#p2").val(p2_local);
            }
            if (p3_local != null && p3_local != '') {
                $("#p3").val(p3_local);
            }
            if (p4_local != null && p4_local != '') {
                $("#p4").val(p4_local);
            }
            if (p5_local != null && p5_local != '') {
                $("#p5").val(p5_local);
            }
            if (p6_local != null && p6_local != '') {
                $("#p6").val(p6_local);
            }
            if (p7_local != null && p7_local != '') {
                $("#p7").val(p7_local);
            }
            if (p8_local != null && p8_local != '') {
                $("#p8").val(p8_local);
            }
        });

        function distribute() {
            var millisecondsToWait = 0;
            $("#btnSubmit").val('Distributing...');


            setTimeout(function () {

                var array = [];

                array.push($("#p1").val().trim());
                array.push($("#p2").val().trim());
                array.push($("#p3").val().trim());
                array.push($("#p4").val().trim());
                array.push($("#p5").val().trim());
                array.push($("#p6").val().trim());
                array.push($("#p7").val().trim());
                array.push($("#p8").val().trim());

                localStorage.setItem("p1", $("#p1").val().trim());
                localStorage.setItem("p2", $("#p2").val().trim());
                localStorage.setItem("p3", $("#p3").val().trim());
                localStorage.setItem("p4", $("#p4").val().trim());
                localStorage.setItem("p5", $("#p5").val().trim());
                localStorage.setItem("p6", $("#p6").val().trim());
                localStorage.setItem("p7", $("#p7").val().trim());
                localStorage.setItem("p8", $("#p8").val().trim());



                var filtered = array.filter(function (el) {
                    return el != "";
                });

                var result = distributeItV2(filtered); // get result
                //print it to card
                if (result != null && result.length > 0) {
                    $("#cardList").html('');
                    for (var i = 0; i < result.length; i++) {
                        $("#cardList").append('<div class="card ' + [i] + '"><div class="card_image"> </div><div class="card_title title-white"><p>' + result[0, i].toString() + ' <br/></p></div></div>');
                    }
                $("#DivStatsBtn").css("display","")
                }

            }, millisecondsToWait);
            $("#btnSubmit").val("Let's Go!");
        }

        //function distributeIt(players) {
        //    if (players.length < 2) {
        //        alert("Provide atleast 2 Players");
        //        return null
        //    }
        //    target = [];
        //    n = players.length;
        //    //depthToPick =6;
        //    depthToPick = n;
        //    array = Array.from({ length: depthToPick + 1 }, (v, k) => k * 1);
        //    array.shift(); // to remove 0 value fro array
        //    var T1shuffled = array.sort(function () { return (.5 - Math.random()) });
        //    console.log(T1shuffled);
        //    var T1selected = T1shuffled.slice(0, n);


        //    var T2shuffled = array.sort(function () { return (.5 - Math.random()) });
        //    console.log(T2shuffled);
        //    var T2selected = T2shuffled.slice(0, n);

        //    for (var i = 0; i < players.length; i++) {
        //        target.push([players[i].toString() + '\n', "&#10; F" + T1selected[i].toString(), "S" + T2selected[i].toString()]);
        //    }
        //    console.log(target);
        //    return target;

        //}


        function distributeItV2(players) {
            if (players.length < 2) {
                alert("Provide atleast 2 Players");
                return null
            }
            target = [];
            n = players.length;
            depthToPick = 5;
            //depthToPick = n;

            mainArray = [];

            T1 = Array.from({ length: depthToPick + 1 }, (v, k) => "F" + (k * 1));
            T1.shift(); // to remove 0 value fro array

            T2 = Array.from({ length: depthToPick + 1 }, (v, k) => "S" + k * 1);
            T2.shift(); // to remove 0 value fro array


            mainArray = T1.concat(T2);

            var shuffled = mainArray.sort(function () { return (.5 - Math.random()) });
            console.log(shuffled);
            var selection = shuffled.slice(0, n * 2);


            for (var i = 0; i < players.length; i++) {

                shuffle(selection);
                var x = pickRandomPlayers(selection);
                target.push("<h3>"+[players[i].toString()  + '</h3>'+ x]);
                localStorage.setItem("C"+(i+1),"<h3>"+[players[i].toString()  + '</h3>'+ x]);
            }
            console.log(target);
            StoreDistributedDataToLocal(target);
            return target;

        }

        function StoreDistributedDataToLocal(target){
            for(var i=0;i< target.length;i++){
                var players = target[i].split("</h3>")[1].split("·");
                for(var j= 0; j<=2;j++){
                    var newi = i+1;
                    var newj = j+1;
                    localStorage.setItem("DP"+newi+newj,players[j])
                }
            }
        }

        function pickRandomPlayers(selection) {
            return selection.slice(0, 3).join('·').toString();
            //.map(fields => fields.join("\n"));
        }

        function randomNumber(min, max) {
            return parseInt(Math.random() * (max - min) + min);
        }

        function shuffle(array) {
            let currentIndex = array.length;

            // While there remain elements to shuffle...
            while (currentIndex != 0) {

                // Pick a remaining element...
                let randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;

                // And swap it with the current element.
                [array[currentIndex], array[randomIndex]] = [
                    array[randomIndex], array[currentIndex]];
            }
        }

//  function fetchFromOffset(offset, cb) {
//              $.get('https://api.cricapi.com/v1/series_info?apikey=110fb904-0998-40b0-89f2-dd1d207e1378&id=76ae85e2-88e5-4e99-83e4-5f352108aebc', function (data) {
//                  if (data.status != "success") { alert("Failed"); return; }
//                  let datarray = data.data;

//  			var  matchitems= datarray["matchList"]
//  					$.each(matchitems, function( index, value ) {
//  					if	(value["date"]== new Date().toISOString().split('T')[0] )
//  						$("#matchTitle").append("<p>"+value["name"] +"</p>");
//  						console.log("Match :" + value["name"] );
//  						console.log("Date :" + value["date"] );
//                         // localStorage.setItem("MatchDate",value["date"])
//                         // localStorage.setItem("MatchValue",value["name"])
//  					});
					
//              });
//          }
//                  fetchFromOffset(0, function (data) {
//                      console.log("Complete data got!", data);
					
// });
    </script>
</body>
</html>
